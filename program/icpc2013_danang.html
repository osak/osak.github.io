<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../style_memoyoushi.css" />




<title>メモ用紙2.0 | ICPC2013 ダナン大会参加記</title>
</head>
<body>
<div id="header">
  <h1 class="title"><a href="../index_memoyoushi.html">メモ用紙2.0</a></h1>
  <address>osak.63 at_mark gmail.com</address>
</div>
<div id="body">
  <div id="menu">
    <ul>
      <li><a href="../about.html">About</a></li>
      <li><a href="index.html">Program</a></li>
      <li><a href="../linux/index.html">Linux</a></li>
      <li><a href="../hardware/index.html">Hardware</a></li>
      <li><a href="../trip/index.html">Trip</a></li>
      <li><a href="../food/index.html">Food</a></li>
      <li><a href="../other/index.html">Other</a></li>
      <li><a href="../diary/index.html">Diary</a></li>
    </ul>
  </div>

  <div id="main">
    <h2 id="icpc2013-">ICPC2013 ダナン大会参加記</h2>

<p>ICPC2013 ダナン大会（ベトナム）にbinding.pryとして参加した。</p>

<p><img src="img/danang_teampc.jpg" alt="" /></p>

<p>チームメンバー、戦略等は<a href="icpc2013_aizu.html">会津のときと同じ</a>。</p>

<p>解いた時間はちゃんと覚えてないので、問題別に反省を書く。</p>

<h3 id="section">全体</h3>
<p>練習セッションで、Runtime ErrorもTLEとして返ってくることが判明する。
ちょっと嫌な感じがするものの、REとTLEはコードから明らかに区別できるだろうということで、あまり問題視はしないことにする。</p>

<p>本番開始前には、コンテスト開始に先んじてPC^2へのログインが許されていて、問題名が全部見える状態になっていた。
せっかくなので問題名から中身の予測をして、各自得意そうなところから読むという分担をした（ベトナム大会は問題文が簡単なので、あまり意味はなかった気がする）。</p>

<p>ベトナム大会の特徴は</p>

<ul>
  <li>実行時間、メモリ使用量ともに制限が明記されていない。聞いても教えてくれない。</li>
  <li>サンプルが弱い。よっぽどのことがない限り、自分でコーナーケースを複数考えておく必要がある。</li>
  <li>ほとんどの問題文はサンプル含めてA4の1ページ＋αに収まっており、シンプルで読みやすい。</li>
  <li>制約が曖昧な場合がある。分からなければClarを投げるべき。</li>
</ul>

<p>といったあたり。</p>

<h3 id="a">A</h3>
<p>得点のリストが与えられるので、同着の一番多い順位を出力する問題。複数ある場合は一番上位を出力する。</p>

<p>読んだ瞬間にやるだけと言って書き始める。</p>

<p>サンプルが通って投げた後で、順位を付けるときに全体をreverseし忘れていたことに気づく。これはひどい……。
直してAC。</p>

<h3 id="j">J</h3>
<p>グラフ上で点Aから点Bまで、K手以内で行く場合の数を求める問題。MOD Mで計算した結果を出力する。
とこはるさんが読んで、行列の累乗和を求めるだけと言ったので書く。</p>

<p>WA。よく見ると、1箇所long longと間違えてintを使い、オーバーフローしていそうなところがあった。</p>

<p>直してもWA。よくわからないので印刷して放置する。</p>

<p>Iを書いている間にとこはるさんがコードと問題をチェックし、Mの上限が10^12のため掛け算をするとlong longでもオーバーフローすることに気づく。
桁ごとにMODを取りつつ掛け算する方式に修正して投げる。AC。</p>

<p>MODを取っているからと言って、オーバーフローを考えなくても良いということにはならない。</p>

<h3 id="i">I</h3>
<p>問題文が長いが、本質的には最後の2行だけだとmikecatさんが主張していて、実際その通りっぽいので書く。
どの桁の数字も異なるような数がひとつ与えられるので、その数より大きく、同様の性質を満たす最小の数を求める問題。</p>

<p>ナイーブな枝刈り探索を書いてAC。</p>

<h3 id="c">C</h3>
<p>L, R ≦ 10^7 が与えられるので、この範囲の整数で、約数の個数がK-maximumなもののうち、最小のものを求める問題。</p>

<p>問題文でK-maximumの定義が書いてあるのだが、この条件が</p>

<ul>
  <li>there are K numbers not greater than X</li>
  <li>there are M-K numbers not smaller than X</li>
</ul>

<p>とX自身を二重カウントするような定義になっていて明らかにおかしい。
Clarを投げるも、問題文をよく読めという答えしか返ってこない。</p>

<p>約数カウント自体はO(N log N)くらいでできるので、[L,R]のすべての数に対して約数の個数を数えるナイーブな実装をする。
K-maximumに関しては仕方ないので、普通にソートしてK番目の要素を採用するようにする。</p>

<p>投げたらTLE。
実際、手元で最大ケースを複数回書くと遅くなっていた。
対応表をmapで持っているのが良くない気がしたので、vectorを使うようにした。
また、約数カウントの結果をキャッシュしておくようにした。</p>

<p>今度はWA。
コードが間違っている気はしないので、K-maximumの定義がおかしいのではないかと考える。
条件がそもそも成立しえないものを書いていて意味不明なのだが、恣意的に解釈すれば、条件のような分割が存在するものをK-maximumとするようにも読めて、この解釈だとK-maximumが2つ存在する可能性がある。</p>

<blockquote>
  <p>たとえば数列が1 2 2 3のとき、(1 2 2) (3) という分割は、2と3の両方に対して上記の条件を満たす。</p>
</blockquote>

<p>まさかとは思いつつ、他に問題が思いつかないので修正して投げる。WA。</p>

<p>K-maximumの定義が怪しい上、ジャッジがあまり問題視してなさそうなため危険な雰囲気があるので、ひとまず諦めて印刷し、暇になったらデバッグすることに決めてFを解く。</p>

<p>Fを解いてからぱっと解ける問題がなさそうだったので、Cに戻ってくる。
mikecatさんがコードを読みながら、素因数分解のコードが間違っていそうと指摘する。
以前に書いた、素因数テーブルを使って素因数分解する方法を使ったのだが、ここで最小の素因数が常にテーブルに入るものと勘違いして、これを利用した高速化を約数の個数カウントに適用していたのが原因だった。</p>

<p>最小の素因数がストックされるように修正して投げる。WA。</p>

<p>K-maximumの定義を最初のものに戻して投げてみる。やっとAC。</p>

<p>この問題は今回最大の失点だった。
素因数分解のコードをバグらせていなければ初回のTLEだけで済んだところを、問題文が悪かったとは言え、無駄にWAを増やしてしまったのは間違いない。
また、約数カウントを篩で求めるという方針はとこはるさんと合意していたものの、アルゴリズムの詳細について認識が食い違っていた。
とこはるさんの考えでは、素因数分解を経由せず、直接的に以下のようなコードで求められるとのこと。</p>

<pre><code>for(i = 1; i &lt;= N; i++) {
    for(j = i; j &lt;= N; j +=i) {
        cnt[j]++;
    }
}
</code></pre>

<p>これは実際O(N log N)で動くのだが、この形はO(N^2)かかると勘違いしていた。</p>

<p>また、自分が書き始めるよりも前にmikecatさんには問題と方針を説明していたらしいので、普通にmikecatさんとコーディングを交代するべきだったのかもしれない
（ただし、会場がとても狭くて動きにくいため、コーダーが交代しづらいという要因もあった）。</p>

<h3 id="f">F</h3>
<p>0と1のみで構成された文字列上に区間を取り、このsubstringを反転したものを区間の末尾に挿入するという操作を繰り返し、文字列sを得る。
このとき、最初の文字列として考えられるものの最短長を求めるという問題。</p>

<p>同じ文字が2個以上連続しているところが任意の個数に縮められることは、容易にわかる。
問題は1個だけしか連続していない箇所をどう処理するかだが、これは左側を見て、2個以上連続している塊であれば、そこを折り返し点として文字列を縮めることができる。
この操作は順番によらず同じ結果になりそうなので、Greedyにこの操作を繰り返していけばよいのではないか？という方針をとこはるさんが考える。
Typical DPのイウィのGreedy解法っぽい。</p>

<p>とりあえず実装してみるとうまく動くので投げる。AC。</p>

<h3 id="b">B</h3>
<p>グラフが与えられて、ここから辺を可能な限り取り除く。
このとき、最初のグラフで連結なものは、操作後も連結なままにしたい。
このような辺の取り除き方の個数を求める問題。</p>

<p>とこはるさんが、これは有名な定理があると言って、謎の立式を始める。
それぞれの連結成分ごとに接続行列を作り、対角成分には頂点の次数×-1を置いた上で行列式を求めるらしい。</p>

<p>よくわからないけどその通りに書く。
なぜか全部0になる。</p>

<p>行列式を求める過程をトレースしてみると、最後の行が全部0になっているっぽい。
最後の行を無視すればよかった気がする、ととこはるさんが言ったのでそうしてみる。
サンプルを食わせると、うまく動いていそうなものと変な値が出ているものがあって、どうも行列式が負数になっているっぽい。</p>

<p>いくつか実験してみると、行列の次数が偶数のときだけ結果が負になっているように見える。
そこだけ修正したらサンプルが合ったので投げてみる。</p>

<p>……と思ったら、何故かPC^2が応答しない。
スタッフを呼んで直してもらう。</p>

<p>気を取り直して再度Submit。無事ACされた。
あとで調べたところ、とこはるさんが最初の行列を正負逆に覚えていたせいで行列式がおかしくなっていたらしい。
結果的には、行列の次数で場合分けするのは妥当な操作だった。</p>

<h3 id="d">D</h3>
<p>Bを通した時点で残り20分。
問題はちゃんと理解していなかったのだが、二部グラフの最小費用マッチングになるというところまで立式されていたので、とこはるさんとmikecatさんが方針を詰めている間に最小費用流ライブラリを写す。
写し終えたところで、とこはるさんとmikecatさんの指示で解答コードを書いていく。</p>

<p>最後まで書いてからコンパイルエラーを修正する。
コンパイルが通ったところで残り10秒くらいだったので急いで提出。</p>

<p>……が、出した瞬間に終了して、ジャッジからはTLEが返ってきた。
たぶんコンテスト終了の意味だと思う
（あとでサンプルを食わせてみたら変な答えが出たので、どっちにしろ通りはしなかった）。</p>

<h3 id="section-1">結果</h3>
<p>最終結果がまだ公式に出ていないが、終了後のレセプションでは総合5位あたりにいる感じで、Second Prizeをもらった。
総合4位とはペナルティの差だけで、ひとつ上ならFirst Prizeでトロフィーまでもらえたらしく、ちょっと悔しい。</p>

<p><img src="img/danang_certificate.jpg" alt="" /></p>

<h3 id="section-2">反省</h3>
<p>結局コーディングは自分ひとりで担当することになってしまった。
今回解いた問題はどれもあまり実装は重くなく、疲労はそんなになかったものの、CやIはmikecatさんが先に読んで問題文まで理解していたはずなので、スイッチしてコーダーを交代するのが普通だと思う
（先述したように、動ける領域が狭くてコーダー交代がすごく面倒だったという背景もあるにはあるが）。</p>

<p>また、全体的にWAを出しすぎである。
特にlong longとintを間違えるなどのミスはもったいない。
会津大会では保守的に全部long longで書いていた記憶があるが、今回は徹底できていなかった。</p>

<p>Cがなかなか通らなかったのと、Bが残り時間が少ない中、完全にとこはるさん頼みで焦ってしまったのとで、ペースが崩れてしまった印象がある。</p>

<p>本番で書いた問題メモ。</p>

<p><img src="img/danang_memo.jpg" alt="" /></p>
 
    
        <div id="kogarasi-program-icpc2013_danang" class="kogarasi-mark">ここにはかつてコメントが表示されていました</div>
    
  </div>
</div>
<div id="footer">
  <p>Last update: 2013-12-01 17:17:06</p>
</div>

</body>
</html>
